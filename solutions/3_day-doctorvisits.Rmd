---
title: "Doctor visits"
output: html_document
editor_options: 
  chunk_output_type: console
---

# Background
In this study, we will use cross-section data from an Australian health survey between 1977 and 1978. Your task is to predict the number of illnesses in the past two weeks based on the self-reported health score, while controlling fo the income, age, and gender.

## Codebook
?AER::DoctorVisits

# Task
1) Build models
You need to build Poisson regression model for testing our hypothesis.

2) Report results
Create a single table that contains all parameter estimates, std. errors, t statistics, and p values.

# Solution
```{r setup}
library(tidyverse)
library(AER)
data("DoctorVisits")
```

# Building the models
```{r}
# Creating a dataset that contains the result of the model in a tidy way
m_control <- glm(illness ~ age + gender + income, family = "poisson", data = DoctorVisits)
summary(m_control)

m_full <- glm(illness ~ health + age + gender + income, family = "poisson", data = DoctorVisits)
summary(m_full)

anova(m_control, m_full)
```

# Printing the results in a table
```{r}
# Printing results using the gt package
library(gt) 

m_full %>% 
  broom::tidy() %>% 
  gt() %>% 
  # Formatting numers to be 2 digits, except for p value (3 digits)
  fmt_number(c("estimate", "std.error", "statistic"), decimals = 2) %>% 
  fmt_number("p.value", decimals = 3) %>% 
  tab_options(row_group.background.color = "grey50")
```

